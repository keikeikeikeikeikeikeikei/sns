import{d as y,r as d,k as w,c,a as e,u as m,e as g,h as k,t as p,g as f,v as _,n as C,o as v,i as V}from"./index-CzD91pAN.js";import{u as N}from"./useMutation-BivMFSN2.js";import{a as B}from"./axios-instance-9reuLYs6.js";import"./useQueryClient-DaGhUnUp.js";const S={class:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100"},z={class:"sticky top-0 z-50 bg-white/80 backdrop-blur-lg border-b border-gray-200"},E={class:"max-w-4xl mx-auto px-4 py-3 flex items-center justify-between"},L={class:"flex items-center gap-4"},M=["disabled"],T={key:0,class:"pi pi-spin pi-spinner mr-2"},j={class:"max-w-4xl mx-auto px-4 py-6"},D={class:"card"},P={key:0,class:"mb-4 p-3 bg-red-50 text-red-600 text-sm rounded-lg"},U={class:"space-y-4"},$={class:"flex justify-end mt-2"},i=1e4,R=y({__name:"NewBlogView",setup(A){const b=V(),a=d(""),s=d(""),l=d(""),r=w(()=>i-s.value.length),u=N({mutationFn:async()=>(await B.post("/blogs",{title:a.value,content:s.value})).data,onSuccess:n=>{b.push(`/blog/${n.id}`)},onError:n=>{var t,o,x;l.value=((x=(o=(t=n.response)==null?void 0:t.data)==null?void 0:o.errors)==null?void 0:x[0])||"投稿に失敗しました"}}),h=()=>{l.value="",a.value.trim()&&s.value.trim()&&s.value.length<=i&&u.mutate()};return(n,t)=>(v(),c("div",S,[e("header",z,[e("div",E,[e("div",L,[e("button",{onClick:t[0]||(t[0]=o=>m(b).back()),class:"btn btn-ghost p-2"},[...t[3]||(t[3]=[e("i",{class:"pi pi-arrow-left"},null,-1)])]),t[4]||(t[4]=e("h1",{class:"text-lg font-semibold"},"ブログを書く",-1))]),e("button",{onClick:h,class:"btn btn-primary",disabled:!a.value.trim()||!s.value.trim()||r.value<0||m(u).isPending.value},[m(u).isPending.value?(v(),c("i",T)):g("",!0),t[5]||(t[5]=k(" 公開する ",-1))],8,M)])]),e("main",j,[e("div",D,[l.value?(v(),c("div",P,p(l.value),1)):g("",!0),e("div",U,[e("div",null,[f(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.value=o),type:"text",class:"w-full text-2xl font-bold border-0 border-b border-gray-200 pb-3 focus:border-primary-500 focus:ring-0 outline-none",placeholder:"タイトル",maxlength:"255"},null,512),[[_,a.value]])]),e("div",null,[f(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.value=o),class:"w-full p-0 border-0 resize-none focus:ring-0 outline-none min-h-[400px] leading-relaxed",placeholder:"本文を書き始める...",maxlength:i},null,512),[[_,s.value]]),e("div",$,[e("span",{class:C(["text-sm",r.value<500?"text-orange-500":"text-gray-400",r.value<0?"text-red-500":""])},p(r.value.toLocaleString())+" / "+p(i.toLocaleString()),3)])])])])])]))}});export{R as default};
