import{d as L,r as x,p as Q,k as z,c as r,a as t,u as l,e as p,f as D,g as I,v as M,n as h,t as n,F as T,j as S,i as N,o}from"./index-CzD91pAN.js";import{u as R}from"./useQuery-BPQ3C_LI.js";import{a as E}from"./axios-instance-9reuLYs6.js";import"./useQueryClient-DaGhUnUp.js";const K={class:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100"},P={class:"sticky top-0 z-50 bg-white/80 backdrop-blur-lg border-b border-gray-200"},U={class:"max-w-4xl mx-auto px-4 py-3 flex items-center gap-4"},G={class:"max-w-4xl mx-auto px-4 py-6"},H={class:"card mb-6"},J={class:"relative flex-1"},O={class:"flex gap-2 mt-4"},W={key:0,class:"text-center py-8"},X={key:1,class:"space-y-6"},Y={key:0},Z={class:"text-sm font-semibold text-gray-500 mb-3"},tt={class:"space-y-3"},et=["onClick"],st={class:"flex items-start gap-3"},at={class:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white font-medium flex-shrink-0"},rt={class:"flex-1 min-w-0"},ot={class:"flex items-center gap-2 mb-1"},nt={class:"px-2 py-0.5 text-xs rounded bg-gray-100 text-gray-600"},it={class:"font-medium text-gray-900"},lt={key:0,class:"font-medium text-gray-800 mb-1"},dt={class:"text-gray-600 text-sm line-clamp-2"},ut={key:1},ct={class:"text-sm font-semibold text-gray-500 mb-3"},pt={class:"space-y-3"},mt={class:"flex items-center gap-3"},yt={class:"w-12 h-12 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white font-medium text-lg"},gt={class:"font-medium text-gray-900"},xt={class:"text-gray-500 text-sm"},ht={key:0,class:"text-gray-600 text-sm mt-1 line-clamp-1"},vt={key:2,class:"text-center py-8 text-gray-500"},ft={key:2,class:"text-center py-8 text-gray-500"},$t=L({__name:"SearchView",setup(_t){const v=Q(),c=N(),i=x(v.query.q||""),u=x(v.query.type||"all"),y=x(i.value),{data:d,isLoading:V,refetch:f}=R({queryKey:["search",i,u],queryFn:async()=>i.value?(await E.get("/search",{params:{q:i.value,type:u.value}})).data:null,enabled:z(()=>!!i.value)}),j=()=>{y.value.trim()&&(i.value=y.value.trim(),c.push({query:{q:i.value,type:u.value}}),f())},g=a=>{u.value=a,i.value&&(c.push({query:{q:i.value,type:a}}),f())},B=a=>{a.type==="feed"?c.push(`/feed/${a.id}`):a.type==="qa"?c.push(`/qa/${a.id}`):a.type==="blog"&&c.push(`/blog/${a.id}`)},F=a=>{switch(a){case"feed":return"つぶやき";case"qa":return"Q&A";case"blog":return"ブログ";default:return a}};return(a,s)=>{var _,b,k,w,q,C,$,A;return o(),r("div",K,[t("header",P,[t("div",U,[t("button",{onClick:s[0]||(s[0]=e=>l(c).push("/")),class:"btn btn-ghost p-2"},[...s[5]||(s[5]=[t("i",{class:"pi pi-arrow-left"},null,-1)])]),s[6]||(s[6]=t("h1",{class:"text-lg font-semibold"},"検索",-1))])]),t("main",G,[t("div",H,[t("form",{onSubmit:D(j,["prevent"]),class:"flex gap-2"},[t("div",J,[s[7]||(s[7]=t("i",{class:"pi pi-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"},null,-1)),I(t("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>y.value=e),type:"text",class:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none",placeholder:"キーワードで検索..."},null,512),[[M,y.value]])]),s[8]||(s[8]=t("button",{type:"submit",class:"btn btn-primary"}," 検索 ",-1))],32),t("div",O,[t("button",{onClick:s[2]||(s[2]=e=>g("all")),class:h(["px-3 py-1 rounded-full text-sm transition-colors",u.value==="all"?"bg-primary-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"])}," すべて ",2),t("button",{onClick:s[3]||(s[3]=e=>g("posts")),class:h(["px-3 py-1 rounded-full text-sm transition-colors",u.value==="posts"?"bg-primary-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"])}," 投稿 ",2),t("button",{onClick:s[4]||(s[4]=e=>g("users")),class:h(["px-3 py-1 rounded-full text-sm transition-colors",u.value==="users"?"bg-primary-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"])}," ユーザー ",2)])]),l(V)?(o(),r("div",W,[...s[9]||(s[9]=[t("i",{class:"pi pi-spin pi-spinner text-2xl text-gray-400"},null,-1)])])):l(d)?(o(),r("div",X,[(b=(_=l(d).posts)==null?void 0:_.data)!=null&&b.length?(o(),r("div",Y,[t("h2",Z," 投稿 ("+n(l(d).posts.meta.total)+"件) ",1),t("div",tt,[(o(!0),r(T,null,S(l(d).posts.data,e=>{var m;return o(),r("div",{key:e.id,onClick:bt=>B(e),class:"card card-hover cursor-pointer"},[t("div",st,[t("div",at,n(((m=e.user.display_name)==null?void 0:m.charAt(0))||e.user.username.charAt(0)),1),t("div",rt,[t("div",ot,[t("span",nt,n(F(e.type)),1),t("span",it,n(e.user.display_name),1)]),e.title?(o(),r("p",lt,n(e.title),1)):p("",!0),t("p",dt,n(e.content),1)])])],8,et)}),128))])])):p("",!0),(w=(k=l(d).users)==null?void 0:k.data)!=null&&w.length?(o(),r("div",ut,[t("h2",ct," ユーザー ("+n(l(d).users.meta.total)+"件) ",1),t("div",pt,[(o(!0),r(T,null,S(l(d).users.data,e=>{var m;return o(),r("div",{key:e.id,class:"card card-hover cursor-pointer"},[t("div",mt,[t("div",yt,n(((m=e.display_name)==null?void 0:m.charAt(0))||e.username.charAt(0)),1),t("div",null,[t("div",gt,n(e.display_name),1),t("div",xt,"@"+n(e.username),1),e.bio?(o(),r("p",ht,n(e.bio),1)):p("",!0)])])])}),128))])])):p("",!0),!((C=(q=l(d).posts)==null?void 0:q.data)!=null&&C.length)&&!((A=($=l(d).users)==null?void 0:$.data)!=null&&A.length)?(o(),r("div",vt," 「"+n(i.value)+"」に一致する結果が見つかりませんでした ",1)):p("",!0)])):i.value?p("",!0):(o(),r("div",ft," キーワードを入力して検索してください "))])])}}});export{$t as default};
